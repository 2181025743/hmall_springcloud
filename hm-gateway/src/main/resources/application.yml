server:
  port: 8080 # 网关使用 8080 端口，无缝对接前端请求
spring:
  application:
    name: gateway # 网关服务名称
  cloud:
    nacos:
      discovery:
        server-addr: 101.42.238.233:8848 # Nacos地址，请根据实际情况修改
    gateway:
      # 全局CORS配置
      globalcors:
        cors-configurations:
          '[/**]': # 匹配所有请求路径
            # allowedOrigins: "*" # (原始配置)
            # --- 修改开始 ---
            # 将 "*" 修改为你的前端Nginx服务器地址
            allowedOrigins: "http://localhost:18080"
            # --- 修改结束 ---
            allowedMethods: # 允许的请求方法
              - GET
              - POST
              - PUT
              - DELETE
              - OPTIONS
            allowedHeaders: "*" # 允许所有请求头
            allowCredentials: true # 是否允许携带Cookie
            maxAge: 360000 # 预检请求的有效期
      # 网关路由规则配置
      routes:
        # 商品服务路由
        - id: item-service
          uri: lb://item-service
          predicates:
            - Path=/items/**,/search/**
        # 用户服务路由
        - id: user-service
          uri: lb://user-service
          predicates:
            - Path=/users/**,/addresses/**
        # 购物车服务路由
        - id: cart-service
          uri: lb://cart-service
          predicates:
            - Path=/carts/**
        # 交易服务路由
        - id: trade-service
          uri: lb://trade-service
          predicates:
            - Path=/orders/**
        # 支付服务路由
        - id: pay-service
          uri: lb://pay-service
          predicates:
            - Path=/pay-orders/**
hm:
  jwt:
    location: classpath:hmall.jks
    alias: hmall
    password: hmall123
  # 认证放行路径配置
  auth:
    excludePaths:
      - /users/login
      - /items/**
      - /search/**
      - /hi